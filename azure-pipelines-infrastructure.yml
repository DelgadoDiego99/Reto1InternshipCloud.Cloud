trigger:
  branches:
    include:
      - "main"
  paths:
    include:
      - "CloudformationTemplates"

pool:
  vmImage: 'ubuntu-latest'

variables:
  BucketTemplateName: 'ToDoWebAppStackTemplates'

steps:
- task: S3Upload@1
  inputs:
    regionName: 'us-east-1'
    bucketName: ''
    sourceFolder: 'Stacks'
    globExpressions: '*.yml'

- task: CloudFormationCreateOrUpdateStack@1
  inputs:
    regionName: 'us-east-1'
    stackName: 'ToDoWebApp'
    templateSource: 'file'
    templateFile: 'main.yml'
    capabilityAutoExpand: true